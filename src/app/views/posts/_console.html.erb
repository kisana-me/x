<div class="post-console">
  <% reactions = post.reactions.pluck(:account_id, :kind) %>
  <% current_reaction = reactions.find { |r| r[0] == @current_account&.id } %>
  <% cr = current_reaction ? current_reaction[1] : nil %>
  <%= button_to("返信 #{post.replies.size}", new_post_path(), params: {replied: post.aid}, method: :get, class: "post-button") %>
  <%= button_to(
    "良 #{reactions.count { |_, kind| kind == "good" }}",
    react_path,
    data: { turbo_stream: true },
    params: {aid: post.aid, kind: "good"},
    class: "post-button #{("post-reacted" if cr == "good")}") %>
  <%= button_to(
    "可 #{reactions.count { |_, kind| kind == "ok" }}",
    react_path,
    data: { turbo_stream: true },
    params: {aid: post.aid, kind: "ok"},
    class: "post-button #{("post-reacted" if cr == "ok")}") %>
  <%= button_to(
    "不可 #{reactions.count { |_, kind| kind == "bad" }}",
    react_path,
    data: { turbo_stream: true },
    params: {aid: post.aid, kind: "bad"},
    class: "post-button #{("post-reacted" if cr == "bad")}") %>
  <% if @current_account && post.account_id == @current_account.id %>
    <%= button_to "投稿削除", post_path(post.aid), method: :delete, class: "post-button" %>
  <% end %>
</div>
